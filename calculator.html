<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VTuber Model Commission Calculator - mondupark</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        /* Custom styles for the calculator */
        .step-content {
            min-height: 500px;
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .step-hidden {
            opacity: 0;
            transform: translateX(-20px);
            display: none;
        }

        .step-visible {
            opacity: 1;
            transform: translateX(0);
        }

        .service-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .service-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(45, 62, 143, 0.15);
        }

        .service-card.selected {
            border-color: #2D3E8F;
            background: rgba(45, 62, 143, 0.05);
            box-shadow: 0 4px 12px rgba(45, 62, 143, 0.2);
        }

        .complexity-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .complexity-card:hover {
            transform: translateY(-4px);
        }

        .complexity-card.selected {
            border-color: #2D3E8F;
            background: rgba(45, 62, 143, 0.05);
        }

        .price-sidebar {
            position: sticky;
            top: 100px;
            max-height: calc(100vh - 120px);
            overflow-y: auto;
        }

        .progress-bar {
            transition: width 0.3s ease;
        }

        .radio-option input[type="radio"] {
            accent-color: #2D3E8F;
        }

        .checkbox-option input[type="checkbox"] {
            accent-color: #2D3E8F;
        }

        .slider-container {
            margin: 20px 0;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #d3d3d3;
            outline: none;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .slider:hover {
            opacity: 1;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #2D3E8F;
            cursor: pointer;
        }

        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #2D3E8F;
            cursor: pointer;
        }

        /* Price highlight animation */
        @keyframes highlight {
            0% { background-color: transparent; }
            50% { background-color: #FEF3C7; }
            100% { background-color: transparent; }
        }

        .price-highlight {
            animation: highlight 1s ease;
        }

        /* Mobile bottom quote panel */
        .mobile-quote-panel {
            display: none;
        }

        .mobile-quote-modal {
            display: none;
        }

        /* Desktop (1024px and above): Hide mobile elements */
        @media (min-width: 1024px) {
            .mobile-quote-panel {
                display: none !important;
            }

            .mobile-quote-modal {
                display: none !important;
            }

            .mobile-quote-modal.active {
                display: none !important;
            }
        }

        /* Mobile/Tablet (below 1024px): Hide desktop sidebar, show mobile panel */
        @media (max-width: 1023px) {
            .price-sidebar {
                display: none !important;
            }

            .mobile-quote-panel {
                display: block;
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: white;
                border-top: 2px solid #2D3E8F;
                box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.1);
                z-index: 1000;
                padding: 12px 16px;
            }

            .mobile-quote-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                cursor: pointer;
            }

            .mobile-quote-modal.active {
                display: flex;
                align-items: center;
                justify-content: center;
                position: fixed;
                inset: 0;
                background: rgba(0, 0, 0, 0.5);
                z-index: 1100;
                padding: 20px;
                overflow-y: auto;
            }

            .mobile-quote-content {
                background: white;
                border-radius: 12px;
                padding: 24px;
                max-width: 500px;
                width: 100%;
                max-height: 80vh;
                overflow-y: auto;
            }

            .step-content {
                padding-bottom: 100px;
            }
        }

        /* Mobile specific adjustments */
        @media (max-width: 767px) {
            .step-content {
                min-height: 400px;
            }
        }

        /* Tablet adjustments */
        @media (min-width: 768px) and (max-width: 1023px) {
            .lg\\:grid {
                display: grid;
                grid-template-columns: 100%;
            }
        }

        /* Touch optimization */
        @media (hover: none) and (pointer: coarse) {
            .slider::-webkit-slider-thumb {
                width: 28px;
                height: 28px;
            }

            .slider::-moz-range-thumb {
                width: 28px;
                height: 28px;
            }

            input[type="checkbox"],
            input[type="radio"] {
                min-width: 20px;
                min-height: 20px;
            }

            button, .btn {
                min-height: 44px;
                padding: 12px 24px;
            }

            .service-card,
            .complexity-card {
                padding: 20px;
            }
        }

        /* Smooth transitions */
        .step-content {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }

        .step-hidden {
            opacity: 0;
            transform: translateX(-20px);
            display: none;
        }

        .step-visible {
            opacity: 1;
            transform: translateX(0);
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Loading spinner */
        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .animate-spin {
            animation: spin 1s linear infinite;
        }

        /* Skip to content link */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #2D3E8F;
            color: white;
            padding: 8px 16px;
            text-decoration: none;
            border-radius: 4px;
            z-index: 100;
        }

        .skip-link:focus {
            top: 10px;
        }

        /* Focus visible styles */
        *:focus-visible {
            outline: 2px solid #2D3E8F;
            outline-offset: 2px;
        }

        /* Required field indicator */
        .required::after {
            content: '*';
            color: #EF4444;
            margin-left: 4px;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Skip to content link for accessibility -->
    <a href="#calculator-main" class="skip-link">Skip to calculator</a>

    <nav class="navbar">
        <div class="container">
            <button class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <a href="index.html" class="nav-brand">mondupark</a>
            <ul class="nav-menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="works.html">Personal Works</a></li>
                <li><a href="projects.html">Projects</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li><a href="calculator.html">Í≤¨Ï†Å Í≥ÑÏÇ∞Í∏∞</a></li>
            </ul>
        </div>
    </nav>

    <!-- Mobile Sidebar -->
    <div class="mobile-sidebar">
        <button class="mobile-close-btn" aria-label="Close menu"></button>
        <ul class="nav-menu">
            <li><a href="index.html">Home</a></li>
            <li><a href="works.html">Personal Works</a></li>
            <li><a href="projects.html">Projects</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="contact.html">Contact</a></li>
            <li><a href="calculator.html">Í≤¨Ï†Å Í≥ÑÏÇ∞Í∏∞</a></li>
        </ul>
    </div>

    <!-- Mobile Overlay -->
    <div class="mobile-overlay"></div>

    <div id="calculator-main" class="container mx-auto px-4 py-8 max-w-7xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold mb-4" style="color: #2D3E8F;">VTuber 3D Model Commission Calculator</h1>
            <p class="text-lg text-gray-600">Get your custom quote in just 16 simple steps</p>
        </div>

        <!-- Opening Message -->
        <div id="openingMessage" class="bg-white rounded-xl shadow-lg p-8 mb-8 border-l-4 border-blue-500">
            <div class="flex items-start gap-4">
                <div class="text-4xl">üí°</div>
                <div>
                    <h3 class="text-xl font-bold mb-2" style="color: #2D3E8F;">Estimated Time: 3-5 minutes</h3>
                    <p class="text-gray-700">Get your custom quote with just a few simple choices.</p>
                    <button onclick="startCalculator()" class="mt-4 px-6 py-3 text-white rounded-lg font-semibold hover:opacity-90 transition" style="background: #2D3E8F;">
                        Start Calculator
                    </button>
                </div>
            </div>
        </div>

        <!-- Calculator Container -->
        <div id="calculatorContainer" class="hidden">
            <!-- Progress Indicator -->
            <div class="bg-white rounded-xl shadow-md p-6 mb-6">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm font-semibold" style="color: #2D3E8F;">Step <span id="currentStep">1</span> / 16</span>
                    <span class="text-sm text-gray-600" id="stepTitle">Service Type</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-3">
                    <div id="progressBar" class="progress-bar h-3 rounded-full" style="background: #2D3E8F; width: 6.25%;"></div>
                </div>
            </div>

            <!-- Main Content Grid -->
            <div class="lg:grid lg:grid-cols-3 lg:gap-8">
                <!-- Left: Steps (70%) -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-xl shadow-lg p-8">
                        <!-- Step 1: Service Type -->
                        <div id="step1" class="step-content step-visible">
                            <h2 class="text-2xl font-bold mb-6" style="color: #1A1D2E;">Choose Your Service Type</h2>
                            <div class="grid md:grid-cols-2 gap-4">
                                <!-- Full Package -->
                                <div class="service-card border-2 rounded-lg p-6" onclick="selectService('full', 8000)">
                                    <input type="radio" name="service" value="full" class="hidden">
                                    <h3 class="text-lg font-bold mb-2" style="color: #2D3E8F;">Full Package</h3>
                                    <p class="text-gray-600 text-sm mb-3">Illustration + 3D Modeling + Rigging</p>
                                    <p class="text-2xl font-bold" style="color: #E67E73;">$8,000</p>
                                </div>

                                <!-- Custom 3D Model -->
                                <div class="service-card border-2 rounded-lg p-6" onclick="selectService('custom', 4000)">
                                    <input type="radio" name="service" value="custom" class="hidden">
                                    <h3 class="text-lg font-bold mb-2" style="color: #2D3E8F;">Custom 3D Model</h3>
                                    <p class="text-gray-600 text-sm mb-3">Modeling + Rigging (client provides illustration)</p>
                                    <p class="text-2xl font-bold" style="color: #E67E73;">$4,000</p>
                                </div>

                                <!-- VRoid Customization -->
                                <div class="service-card border-2 rounded-lg p-6" onclick="selectService('vroid', 1500)">
                                    <input type="radio" name="service" value="vroid" class="hidden">
                                    <h3 class="text-lg font-bold mb-2" style="color: #2D3E8F;">VRoid Customization</h3>
                                    <p class="text-gray-600 text-sm mb-3">VRoid base modification + Rigging</p>
                                    <p class="text-2xl font-bold mb-2" style="color: #E67E73;">$1,500</p>
                                    <p class="text-xs text-gray-500 italic">Perfect for streamers who want to test their concept before committing to a full custom model. Great for beginners exploring VTubing or trying out different styles.</p>
                                    <p class="text-xs text-gray-500 mt-2">*Depending on complexity and schedule, this service may involve collaboration with specialized VRoid artists.</p>
                                </div>

                                <!-- Rigging Only -->
                                <div class="service-card border-2 rounded-lg p-6" onclick="selectService('rigging', 800)">
                                    <input type="radio" name="service" value="rigging" class="hidden">
                                    <h3 class="text-lg font-bold mb-2" style="color: #2D3E8F;">Rigging Only</h3>
                                    <p class="text-gray-600 text-sm mb-3">Add rigging to completed model</p>
                                    <p class="text-2xl font-bold mb-2" style="color: #E67E73;">$800</p>
                                    <p class="text-xs text-gray-500 italic">Ideal for bringing your existing 3D model to life for streaming. Perfect for testing the waters with VTubing or upgrading a pre-made model.</p>
                                    <p class="text-xs text-gray-500 mt-2">*Great option for creators who already have a model but need professional rigging and optimization.</p>
                                </div>
                            </div>
                        </div>

                        <!-- Step 2: Body Type -->
                        <div id="step2" class="step-content step-hidden">
                            <h2 class="text-2xl font-bold mb-6" style="color: #1A1D2E;">Select Body Type</h2>
                            <div class="space-y-4">
                                <label class="radio-option flex items-center p-4 border-2 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                    <input type="radio" name="bodyType" value="fullbody" onchange="selectBodyType('fullbody', 1.0)" class="mr-4 w-5 h-5">
                                    <div class="flex-1">
                                        <div class="font-bold text-lg" style="color: #2D3E8F;">Fullbody</div>
                                        <div class="text-gray-600 text-sm">Complete character from head to toe</div>
                                    </div>
                                    <div class="text-gray-500">√ó1.0</div>
                                </label>

                                <label class="radio-option flex items-center p-4 border-2 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                    <input type="radio" name="bodyType" value="halfbody" onchange="selectBodyType('halfbody', 0.7)" class="mr-4 w-5 h-5">
                                    <div class="flex-1">
                                        <div class="font-bold text-lg" style="color: #2D3E8F;">Halfbody</div>
                                        <div class="text-gray-600 text-sm">Upper body focus (waist up)</div>
                                    </div>
                                    <div class="text-gray-500">√ó0.7</div>
                                </label>

                                <label class="radio-option flex items-center p-4 border-2 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                    <input type="radio" name="bodyType" value="chibi" onchange="selectBodyType('chibi', 0.6)" class="mr-4 w-5 h-5">
                                    <div class="flex-1">
                                        <div class="font-bold text-lg" style="color: #2D3E8F;">Chibi (SD)</div>
                                        <div class="text-gray-600 text-sm">Cute, simplified proportions</div>
                                    </div>
                                    <div class="text-gray-500">√ó0.6</div>
                                </label>
                            </div>
                        </div>

                        <!-- Step 3: Platform -->
                        <div id="step3" class="step-content step-hidden">
                            <h2 class="text-2xl font-bold mb-6" style="color: #1A1D2E;">Platform Selection</h2>

                            <div class="bg-green-50 border-2 border-green-200 rounded-lg p-6 mb-6">
                                <h3 class="font-bold text-lg mb-4" style="color: #2D3E8F;">‚úÖ Included as Standard</h3>
                                <ul class="space-y-2 text-gray-700">
                                    <li class="flex items-center"><span class="text-green-600 mr-2">‚úì</span> VRM 1.0 Standard (VSeeFace, Warudo, etc.)</li>
                                    <li class="flex items-center"><span class="text-green-600 mr-2">‚úì</span> Unity Package</li>
                                    <li class="flex items-center"><span class="text-green-600 mr-2">‚úì</span> Final Textures</li>
                                </ul>
                            </div>

                            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-sm text-gray-700">
                                üí° Commercial rights and additional platform options are available in the following steps.
                            </div>
                        </div>

                        <!-- Step 4: Character Complexity -->
                        <div id="step4" class="step-content step-hidden">
                            <h2 class="text-2xl font-bold mb-6" style="color: #1A1D2E;">Character Complexity</h2>
                            <div class="grid md:grid-cols-3 gap-4 mb-4">
                                <!-- Simple -->
                                <div class="complexity-card border-2 rounded-lg p-4 cursor-pointer" onclick="selectComplexity('simple', 1.0)">
                                    <div class="aspect-square bg-gray-200 rounded-lg mb-3 flex items-center justify-center text-gray-400">
                                        <span class="text-sm">Sample Image</span>
                                    </div>
                                    <h3 class="font-bold text-lg mb-2" style="color: #2D3E8F;">Simple</h3>
                                    <p class="text-sm text-gray-600 mb-2">Short hair, simple outfit, 0-2 accessories</p>
                                    <p class="font-bold" style="color: #E67E73;">√ó1.0</p>
                                </div>

                                <!-- Standard -->
                                <div class="complexity-card border-2 rounded-lg p-4 cursor-pointer" onclick="selectComplexity('standard', 1.4)">
                                    <div class="aspect-square bg-gray-200 rounded-lg mb-3 flex items-center justify-center text-gray-400">
                                        <span class="text-sm">Sample Image</span>
                                    </div>
                                    <h3 class="font-bold text-lg mb-2" style="color: #2D3E8F;">Standard</h3>
                                    <p class="text-sm text-gray-600 mb-2">Long hair, layered outfit, 3-5 accessories</p>
                                    <p class="font-bold" style="color: #E67E73;">√ó1.4</p>
                                </div>

                                <!-- Complex -->
                                <div class="complexity-card border-2 rounded-lg p-4 cursor-pointer" onclick="selectComplexity('complex', 1.8)">
                                    <div class="aspect-square bg-gray-200 rounded-lg mb-3 flex items-center justify-center text-gray-400">
                                        <span class="text-sm">Sample Image</span>
                                    </div>
                                    <h3 class="font-bold text-lg mb-2" style="color: #2D3E8F;">Complex</h3>
                                    <p class="text-sm text-gray-600 mb-2">Very long hair, armor/dress, 6+ accessories</p>
                                    <p class="font-bold" style="color: #E67E73;">√ó1.8</p>
                                </div>
                            </div>
                            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-sm text-gray-700">
                                üí° Final pricing may be adjusted after reviewing your references
                            </div>
                        </div>

                        <!-- Step 5: What's Included -->
                        <div id="step5" class="step-content step-hidden">
                            <h2 class="text-2xl font-bold mb-6" style="color: #1A1D2E;">What's Included</h2>

                            <div class="space-y-6">
                                <div class="border-2 border-green-200 rounded-lg p-6 bg-green-50">
                                    <h3 class="font-bold text-lg mb-4" style="color: #2D3E8F;">‚úÖ Standard Package Includes:</h3>
                                    <ul class="space-y-2 text-gray-700">
                                        <li class="flex items-start"><span class="text-green-600 mr-2 mt-1">‚úì</span>Head + Body 3D Model</li>
                                        <li class="flex items-start"><span class="text-green-600 mr-2 mt-1">‚úì</span>Base Textures (PBR)</li>
                                        <li class="flex items-start"><span class="text-green-600 mr-2 mt-1">‚úì</span>Basic Facial Rigging (5 expressions + lipsync + eye blink)</li>
                                        <li class="flex items-start"><span class="text-green-600 mr-2 mt-1">‚úì</span>Full Body Rigging (bone structure)</li>
                                        <li class="flex items-start"><span class="text-green-600 mr-2 mt-1">‚úì</span>Lipsync (A, I, U, E, O)</li>
                                        <li class="flex items-start"><span class="text-green-600 mr-2 mt-1">‚úì</span>Eye Blink + Eye Tracking</li>
                                        <li class="flex items-start"><span class="text-green-600 mr-2 mt-1">‚úì</span>Basic Physics (hair, clothing)</li>
                                    </ul>
                                </div>

                                <div class="border-2 rounded-lg p-6">
                                    <h3 class="font-bold text-lg mb-4" style="color: #2D3E8F;">üìÅ Deliverables:</h3>
                                    <ul class="space-y-2 text-gray-700">
                                        <li>‚Ä¢ VRM file (.vrm)</li>
                                        <li>‚Ä¢ Unity package (.unitypackage)</li>
                                        <li>‚Ä¢ Texture files (PNG)</li>
                                    </ul>
                                </div>

                                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-sm text-gray-700">
                                    üí° Additional options like ARKit tracking, extra expressions, and source files are available in the following steps.
                                </div>
                            </div>
                        </div>

                        <!-- Step 6: Expressions & Emotes -->
                        <div id="step6" class="step-content step-hidden">
                            <h2 class="text-2xl font-bold mb-6" style="color: #1A1D2E;">Expressions & Emotes</h2>

                            <div class="space-y-6">
                                <!-- Additional Expressions -->
                                <div class="border-2 rounded-lg p-6">
                                    <label class="font-bold text-lg mb-4 block" style="color: #2D3E8F;">Additional Expressions ($50/each)</label>
                                    <div class="flex items-center justify-between mb-2">
                                        <span class="text-gray-700">Count: <span id="additionalExpressionsCount" class="font-bold">0</span></span>
                                        <span class="font-bold" style="color: #E67E73;">+$<span id="additionalExpressionsPrice">0</span></span>
                                    </div>
                                    <input type="range" min="0" max="20" value="0" class="slider" id="additionalExpressions" oninput="updateSlider('additionalExpressions', 50, 20)">
                                    <div class="flex justify-between text-xs text-gray-500 mt-1">
                                        <span>0</span>
                                        <span>20</span>
                                    </div>
                                </div>

                                <!-- Custom Expressions -->
                                <div class="border-2 rounded-lg p-6">
                                    <label class="font-bold text-lg mb-4 block" style="color: #2D3E8F;">Custom Expressions ($80/each)</label>
                                    <p class="text-sm text-gray-600 mb-4">Specific requests like crying, blushing, etc.</p>
                                    <div class="flex items-center justify-between mb-2">
                                        <span class="text-gray-700">Count: <span id="customExpressionsCount" class="font-bold">0</span></span>
                                        <span class="font-bold" style="color: #E67E73;">+$<span id="customExpressionsPrice">0</span></span>
                                    </div>
                                    <input type="range" min="0" max="10" value="0" class="slider" id="customExpressions" oninput="updateSlider('customExpressions', 80, 10)">
                                    <div class="flex justify-between text-xs text-gray-500 mt-1">
                                        <span>0</span>
                                        <span>10</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 7: Hand Poses -->
                        <div id="step7" class="step-content step-hidden">
                            <h2 class="text-2xl font-bold mb-6" style="color: #1A1D2E;">Hand Poses</h2>

                            <div class="border-2 rounded-lg p-6">
                                <label class="font-bold text-lg mb-4 block" style="color: #2D3E8F;">Additional Hand Poses ($100/each)</label>
                                <p class="text-sm text-gray-600 mb-4">Beyond the standard open/closed hands</p>
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-gray-700">Count: <span id="handPosesCount" class="font-bold">0</span></span>
                                    <span class="font-bold" style="color: #E67E73;">+$<span id="handPosesPrice">0</span></span>
                                </div>
                                <input type="range" min="0" max="10" value="0" class="slider" id="handPoses" oninput="updateSlider('handPoses', 100, 10)">
                                <div class="flex justify-between text-xs text-gray-500 mt-1">
                                    <span>0</span>
                                    <span>10</span>
                                </div>
                            </div>
                        </div>

                        <!-- Step 8: Outfits & Hair -->
                        <div id="step8" class="step-content step-hidden">
                            <h2 class="text-2xl font-bold mb-6" style="color: #1A1D2E;">Outfits & Hair</h2>

                            <div class="space-y-6">
                                <!-- Additional Outfits -->
                                <div class="border-2 rounded-lg p-6">
                                    <label class="font-bold text-lg mb-4 block" style="color: #2D3E8F;">Additional Outfits ($600/each)</label>
                                    <div class="flex items-center justify-between mb-2">
                                        <span class="text-gray-700">Count: <span id="outfitsCount" class="font-bold">0</span></span>
                                        <span class="font-bold" style="color: #E67E73;">+$<span id="outfitsPrice">0</span></span>
                                    </div>
                                    <input type="range" min="0" max="3" value="0" class="slider" id="outfits" oninput="updateSlider('outfits', 600, 3)">
                                    <div class="flex justify-between text-xs text-gray-500 mt-1">
                                        <span>0</span>
                                        <span>3</span>
                                    </div>
                                </div>

                                <!-- Additional Hairstyles -->
                                <div class="border-2 rounded-lg p-6">
                                    <label class="font-bold text-lg mb-4 block" style="color: #2D3E8F;">Additional Hairstyles ($350/each)</label>
                                    <div class="flex items-center justify-between mb-2">
                                        <span class="text-gray-700">Count: <span id="hairstylesCount" class="font-bold">0</span></span>
                                        <span class="font-bold" style="color: #E67E73;">+$<span id="hairstylesPrice">0</span></span>
                                    </div>
                                    <input type="range" min="0" max="3" value="0" class="slider" id="hairstyles" oninput="updateSlider('hairstyles', 350, 3)">
                                    <div class="flex justify-between text-xs text-gray-500 mt-1">
                                        <span>0</span>
                                        <span>3</span>
                                    </div>
                                </div>

                                <!-- Toggle Accessories -->
                                <div class="border-2 rounded-lg p-6">
                                    <label class="font-bold text-lg mb-4 block" style="color: #2D3E8F;">Toggle Accessories ($120/each)</label>
                                    <p class="text-sm text-gray-600 mb-4">Items that can be turned on/off (glasses, hats, etc.)</p>
                                    <div class="flex items-center justify-between mb-2">
                                        <span class="text-gray-700">Count: <span id="toggleAccessoriesCount" class="font-bold">0</span></span>
                                        <span class="font-bold" style="color: #E67E73;">+$<span id="toggleAccessoriesPrice">0</span></span>
                                    </div>
                                    <input type="range" min="0" max="5" value="0" class="slider" id="toggleAccessories" oninput="updateSlider('toggleAccessories', 120, 5)">
                                    <div class="flex justify-between text-xs text-gray-500 mt-1">
                                        <span>0</span>
                                        <span>5</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 9: Special Parts & Tracking -->
                        <div id="step9" class="step-content step-hidden">
                            <h2 class="text-2xl font-bold mb-6" style="color: #1A1D2E;">Special Parts & Tracking</h2>

                            <div class="space-y-6">
                                <!-- Special Parts -->
                                <div class="border-2 rounded-lg p-6">
                                    <h3 class="font-bold text-lg mb-4" style="color: #2D3E8F;">Special Parts</h3>
                                    <div class="space-y-3">
                                        <label class="checkbox-option flex items-start p-3 border rounded-lg cursor-pointer hover:bg-gray-50 transition">
                                            <input type="checkbox" id="animalParts" onchange="updateCheckbox('animalParts', 250)" class="mr-4 mt-1 w-5 h-5">
                                            <div class="flex-1">
                                                <div class="font-bold">Animal Ears + Tail</div>
                                                <div class="text-sm text-gray-600">Includes rigging and physics</div>
                                            </div>
                                            <div class="font-semibold" style="color: #E67E73;">+$250</div>
                                        </label>

                                        <label class="checkbox-option flex items-start p-3 border rounded-lg cursor-pointer hover:bg-gray-50 transition">
                                            <input type="checkbox" id="wings" onchange="updateCheckbox('wings', 300)" class="mr-4 mt-1 w-5 h-5">
                                            <div class="flex-1">
                                                <div class="font-bold">Wings</div>
                                                <div class="text-sm text-gray-600">Angel, demon, or fairy wings</div>
                                            </div>
                                            <div class="font-semibold" style="color: #E67E73;">+$300</div>
                                        </label>

                                        <label class="checkbox-option flex items-start p-3 border rounded-lg cursor-pointer hover:bg-gray-50 transition">
                                            <input type="checkbox" id="horns" onchange="updateCheckbox('horns', 180)" class="mr-4 mt-1 w-5 h-5">
                                            <div class="flex-1">
                                                <div class="font-bold">Horns/Antennae</div>
                                                <div class="text-sm text-gray-600">Custom horn design</div>
                                            </div>
                                            <div class="font-semibold" style="color: #E67E73;">+$180</div>
                                        </label>

                                        <label class="checkbox-option flex items-start p-3 border rounded-lg cursor-pointer hover:bg-gray-50 transition">
                                            <input type="checkbox" id="glowEffects" onchange="updateCheckbox('glowEffects', 200)" class="mr-4 mt-1 w-5 h-5">
                                            <div class="flex-1">
                                                <div class="font-bold">Glow Effects</div>
                                                <div class="text-sm text-gray-600">Emissive textures and materials</div>
                                            </div>
                                            <div class="font-semibold" style="color: #E67E73;">+$200</div>
                                        </label>
                                    </div>
                                </div>

                                <!-- Tracking & Technical -->
                                <div class="border-2 rounded-lg p-6">
                                    <h3 class="font-bold text-lg mb-4" style="color: #2D3E8F;">Tracking & Technical</h3>
                                    <div class="space-y-3">
                                        <label class="checkbox-option flex items-start p-3 border rounded-lg cursor-pointer hover:bg-gray-50 transition">
                                            <input type="checkbox" id="handTracking" onchange="updateCheckbox('handTracking', 350)" class="mr-4 mt-1 w-5 h-5">
                                            <div class="flex-1">
                                                <div class="font-bold">Hand Tracking Support</div>
                                                <div class="text-sm text-gray-600">Leap Motion / VR controller support</div>
                                            </div>
                                            <div class="font-semibold" style="color: #E67E73;">+$350</div>
                                        </label>

                                        <label class="checkbox-option flex items-start p-3 border rounded-lg cursor-pointer hover:bg-gray-50 transition">
                                            <input type="checkbox" id="fullBodyTracking" onchange="updateCheckbox('fullBodyTracking', 500)" class="mr-4 mt-1 w-5 h-5">
                                            <div class="flex-1">
                                                <div class="font-bold">Full Body Tracking</div>
                                                <div class="text-sm text-gray-600">Optimized for Vive trackers</div>
                                            </div>
                                            <div class="font-semibold" style="color: #E67E73;">+$500</div>
                                        </label>

                                        <label class="checkbox-option flex items-start p-3 border rounded-lg cursor-pointer hover:bg-gray-50 transition">
                                            <input type="checkbox" id="advancedLipsync" onchange="updateCheckbox('advancedLipsync', 180)" class="mr-4 mt-1 w-5 h-5">
                                            <div class="flex-1">
                                                <div class="font-bold">Advanced Lipsync</div>
                                                <div class="text-sm text-gray-600">10 visemes for realistic speech</div>
                                            </div>
                                            <div class="font-semibold" style="color: #E67E73;">+$180</div>
                                        </label>

                                        <label class="checkbox-option flex items-start p-3 border rounded-lg cursor-pointer hover:bg-gray-50 transition">
                                            <input type="checkbox" id="iphoneArkit" onchange="updateCheckbox('iphoneArkit', 400)" class="mr-4 mt-1 w-5 h-5">
                                            <div class="flex-1">
                                                <div class="font-bold">iPhone ARKit Facial Tracking</div>
                                                <div class="text-sm text-gray-600">52 ARKit blendshapes + iFacialMocap / VSeeFace compatibility</div>
                                            </div>
                                            <div class="font-semibold" style="color: #E67E73;">+$400</div>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 10: Source Files -->
                        <div id="step10" class="step-content step-hidden">
                            <h2 class="text-2xl font-bold mb-6" style="color: #1A1D2E;">Source Files</h2>

                            <div class="bg-green-50 border-2 border-green-200 rounded-lg p-6 mb-6">
                                <h3 class="font-bold text-lg mb-4" style="color: #2D3E8F;">‚úÖ Included as Standard</h3>
                                <ul class="space-y-2 text-gray-700">
                                    <li class="flex items-center"><span class="text-green-600 mr-2">‚úì</span> VRM File</li>
                                    <li class="flex items-center"><span class="text-green-600 mr-2">‚úì</span> Unity Package</li>
                                    <li class="flex items-center"><span class="text-green-600 mr-2">‚úì</span> Texture PNG</li>
                                </ul>
                            </div>

                            <div class="border-2 rounded-lg p-6">
                                <h3 class="font-bold text-lg mb-4" style="color: #2D3E8F;">Additional Source Files</h3>
                                <div class="space-y-3">
                                    <label class="checkbox-option flex items-start p-3 border rounded-lg cursor-pointer hover:bg-gray-50 transition">
                                        <input type="checkbox" id="blenderSource" onchange="updateCheckbox('blenderSource', 350)" class="mr-4 mt-1 w-5 h-5">
                                        <div class="flex-1">
                                            <div class="font-bold">Blender Source Files</div>
                                            <div class="text-sm text-gray-600">.blend files with full editing capability</div>
                                        </div>
                                        <div class="font-semibold" style="color: #E67E73;">+$350</div>
                                    </label>

                                    <label class="checkbox-option flex items-start p-3 border rounded-lg cursor-pointer hover:bg-gray-50 transition">
                                        <input type="checkbox" id="fbxPsdSource" onchange="updateCheckbox('fbxPsdSource', 280)" class="mr-4 mt-1 w-5 h-5">
                                        <div class="flex-1">
                                            <div class="font-bold">FBX + PSD Source</div>
                                            <div class="text-sm text-gray-600">Mesh and layered texture files</div>
                                        </div>
                                        <div class="font-semibold" style="color: #E67E73;">+$280</div>
                                    </label>

                                    <label class="checkbox-option flex items-start p-3 border rounded-lg cursor-pointer hover:bg-gray-50 transition">
                                        <input type="checkbox" id="completeSource" onchange="updateCheckbox('completeSource', 600)" class="mr-4 mt-1 w-5 h-5">
                                        <div class="flex-1">
                                            <div class="font-bold">Complete Source File Package</div>
                                            <div class="text-sm text-gray-600">All source files + project files</div>
                                        </div>
                                        <div class="font-semibold" style="color: #E67E73;">+$600</div>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Step 11: Commercial Rights -->
                        <div id="step11" class="step-content step-hidden">
                            <h2 class="text-2xl font-bold mb-6" style="color: #1A1D2E;">Commercial Rights</h2>

                            <div class="space-y-4">
                                <label class="radio-option flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                    <input type="radio" name="commercialRights" value="personal" onchange="selectCommercialRights('personal', 1.0)" class="mr-4 mt-1 w-5 h-5" checked>
                                    <div class="flex-1">
                                        <div class="font-bold text-lg" style="color: #2D3E8F;">Personal Use Only</div>
                                        <div class="text-sm text-gray-600">Non-monetized content only</div>
                                    </div>
                                    <div class="text-gray-500">√ó1.0</div>
                                </label>

                                <label class="radio-option flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                    <input type="radio" name="commercialRights" value="commercial" onchange="selectCommercialRights('commercial', 1.2)" class="mr-4 mt-1 w-5 h-5">
                                    <div class="flex-1">
                                        <div class="font-bold text-lg" style="color: #2D3E8F;">Commercial Use</div>
                                        <div class="text-sm text-gray-600">Monetization allowed (streaming, videos, etc.)</div>
                                    </div>
                                    <div class="font-bold" style="color: #E67E73;">√ó1.2</div>
                                </label>

                                <label class="radio-option flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                    <input type="radio" name="commercialRights" value="merchandise" onchange="selectCommercialRights('merchandise', 1.3)" class="mr-4 mt-1 w-5 h-5">
                                    <div class="flex-1">
                                        <div class="font-bold text-lg" style="color: #2D3E8F;">Merchandise Rights</div>
                                        <div class="text-sm text-gray-600">Includes physical/digital product sales</div>
                                    </div>
                                    <div class="font-bold" style="color: #E67E73;">√ó1.3</div>
                                </label>

                                <label class="radio-option flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                    <input type="radio" name="commercialRights" value="full" onchange="selectCommercialRights('full', 1.5)" class="mr-4 mt-1 w-5 h-5">
                                    <div class="flex-1">
                                        <div class="font-bold text-lg" style="color: #2D3E8F;">Full Rights Transfer</div>
                                        <div class="text-sm text-gray-600">Complete ownership (requires source files)</div>
                                    </div>
                                    <div class="font-bold" style="color: #E67E73;">√ó1.5</div>
                                </label>
                            </div>
                        </div>

                        <!-- Step 12: Delivery Timeline -->
                        <div id="step12" class="step-content step-hidden">
                            <h2 class="text-2xl font-bold mb-6" style="color: #1A1D2E;">Delivery Timeline</h2>

                            <div class="space-y-4">
                                <label class="radio-option flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                    <input type="radio" name="timeline" value="relaxed" onchange="selectTimeline('relaxed', 0.95)" class="mr-4 mt-1 w-5 h-5">
                                    <div class="flex-1">
                                        <div class="font-bold text-lg" style="color: #2D3E8F;">Relaxed (10-12 weeks)</div>
                                        <div class="text-sm text-gray-600">No rush, flexible schedule</div>
                                    </div>
                                    <div class="font-bold text-green-600">√ó0.95</div>
                                </label>

                                <label class="radio-option flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                    <input type="radio" name="timeline" value="standard" onchange="selectTimeline('standard', 1.0)" class="mr-4 mt-1 w-5 h-5" checked>
                                    <div class="flex-1">
                                        <div class="font-bold text-lg" style="color: #2D3E8F;">Standard (8-10 weeks)</div>
                                        <div class="text-sm text-gray-600">Normal production pace</div>
                                    </div>
                                    <div class="text-gray-500">√ó1.0</div>
                                </label>

                                <label class="radio-option flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                    <input type="radio" name="timeline" value="rush" onchange="selectTimeline('rush', 1.3)" class="mr-4 mt-1 w-5 h-5">
                                    <div class="flex-1">
                                        <div class="font-bold text-lg" style="color: #2D3E8F;">Rush (6 weeks)</div>
                                        <div class="text-sm text-gray-600">Priority production</div>
                                    </div>
                                    <div class="font-bold" style="color: #E67E73;">√ó1.3</div>
                                </label>

                                <label class="radio-option flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                    <input type="radio" name="timeline" value="express" onchange="selectTimeline('express', 1.6)" class="mr-4 mt-1 w-5 h-5">
                                    <div class="flex-1">
                                        <div class="font-bold text-lg" style="color: #2D3E8F;">Express (4 weeks)</div>
                                        <div class="text-sm text-gray-600">Maximum priority</div>
                                    </div>
                                    <div class="font-bold" style="color: #E67E73;">√ó1.6</div>
                                </label>
                            </div>

                            <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 text-sm text-gray-700 mt-6">
                                ‚ö†Ô∏è Rush and Express timelines are subject to availability
                            </div>
                        </div>

                        <!-- Step 13: Revision Rounds -->
                        <div id="step13" class="step-content step-hidden">
                            <h2 class="text-2xl font-bold mb-6" style="color: #1A1D2E;">Revision Rounds</h2>

                            <div class="space-y-4">
                                <label class="radio-option flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                    <input type="radio" name="revisions" value="standard" onchange="selectRevisions('standard', 1.0)" class="mr-4 mt-1 w-5 h-5" checked>
                                    <div class="flex-1">
                                        <div class="font-bold text-lg" style="color: #2D3E8F;">Standard (1 revision per stage)</div>
                                        <div class="text-sm text-gray-600">One round of changes at each milestone</div>
                                    </div>
                                    <div class="text-gray-500">√ó1.0</div>
                                </label>

                                <label class="radio-option flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                    <input type="radio" name="revisions" value="extended" onchange="selectRevisions('extended', 1.15)" class="mr-4 mt-1 w-5 h-5">
                                    <div class="flex-1">
                                        <div class="font-bold text-lg" style="color: #2D3E8F;">Extended (3 revisions per stage)</div>
                                        <div class="text-sm text-gray-600">More flexibility for refinements</div>
                                    </div>
                                    <div class="font-bold" style="color: #E67E73;">√ó1.15</div>
                                </label>

                                <label class="radio-option flex items-start p-4 border-2 rounded-lg cursor-pointer hover:border-blue-500 transition">
                                    <input type="radio" name="revisions" value="unlimited" onchange="selectRevisions('unlimited', 1.35)" class="mr-4 mt-1 w-5 h-5">
                                    <div class="flex-1">
                                        <div class="font-bold text-lg" style="color: #2D3E8F;">Unlimited Revisions</div>
                                        <div class="text-sm text-gray-600">As many iterations as needed</div>
                                    </div>
                                    <div class="font-bold" style="color: #E67E73;">√ó1.35</div>
                                </label>
                            </div>

                            <div class="bg-blue-50 border-l-4 border-blue-500 p-4 text-sm text-gray-700 mt-6">
                                üí° Revisions are major changes. Minor tweaks and bug fixes are always included.
                            </div>
                        </div>

                        <!-- Step 14: Confidentiality -->
                        <div id="step14" class="step-content step-hidden">
                            <h2 class="text-2xl font-bold mb-6" style="color: #1A1D2E;">Confidentiality</h2>

                            <div class="border-2 rounded-lg p-6">
                                <label class="checkbox-option flex items-start cursor-pointer">
                                    <input type="checkbox" id="privateCommission" onchange="updateCheckbox('privateCommission', 600)" class="mr-4 mt-1 w-5 h-5">
                                    <div class="flex-1">
                                        <div class="font-bold text-xl mb-2" style="color: #2D3E8F;">Private Commission</div>
                                        <p class="text-gray-700 mb-3">Work-in-progress will not be shared on social media or portfolio. Final model remains private unless you give permission.</p>
                                        <ul class="text-sm text-gray-600 space-y-1 mb-3">
                                            <li>‚Ä¢ No WIP posts on social media</li>
                                            <li>‚Ä¢ Not included in portfolio</li>
                                            <li>‚Ä¢ NDA available upon request</li>
                                            <li>‚Ä¢ Full discretion maintained</li>
                                        </ul>
                                        <div class="font-bold text-xl" style="color: #E67E73;">+$600</div>
                                    </div>
                                </label>
                            </div>

                        </div>

                        <!-- Step 15: Reference Upload -->
                        <div id="step15" class="step-content step-hidden">
                            <h2 class="text-2xl font-bold mb-6" style="color: #1A1D2E;">Reference Images & Details</h2>

                            <div class="space-y-6">
                                <!-- Image Upload -->
                                <div class="border-2 rounded-lg p-6">
                                    <h3 class="font-bold text-lg mb-4" style="color: #2D3E8F;">üìé Reference Images</h3>
                                    <div id="dropZone" class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center cursor-pointer hover:border-blue-500 transition"
                                         ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)" onclick="document.getElementById('fileInput').click()">
                                        <div class="text-gray-600">
                                            <div class="text-4xl mb-2">üìÅ</div>
                                            <p class="font-semibold mb-1">Drag images here or click to upload</p>
                                            <p class="text-sm">(Max 5 images, 10MB each)</p>
                                            <p class="text-xs mt-2 text-gray-500">Supported: JPG, PNG, WEBP</p>
                                        </div>
                                        <input type="file" id="fileInput" accept="image/jpeg,image/png,image/webp" multiple class="hidden" onchange="handleFileSelect(event)">
                                    </div>

                                    <!-- Image Previews -->
                                    <div id="imagePreviews" class="grid grid-cols-5 gap-3 mt-4"></div>
                                </div>

                                <!-- URL Input -->
                                <div class="border-2 rounded-lg p-6">
                                    <h3 class="font-bold text-lg mb-4" style="color: #2D3E8F;">üîó Pinterest / ArtStation URLs</h3>
                                    <textarea id="referenceUrls" rows="4" class="w-full p-3 border-2 rounded-lg focus:border-blue-500 focus:outline-none"
                                              placeholder="Add reference URLs, one per line&#10;https://pinterest.com/...&#10;https://www.artstation.com/..."></textarea>
                                </div>

                                <!-- Additional Notes -->
                                <div class="border-2 rounded-lg p-6">
                                    <h3 class="font-bold text-lg mb-4" style="color: #2D3E8F;">üí¨ Additional Requests</h3>
                                    <textarea id="additionalNotes" rows="5" maxlength="500" class="w-full p-3 border-2 rounded-lg focus:border-blue-500 focus:outline-none"
                                              placeholder="Share any specific preferences about colors, style, or special features you'd like to emphasize"
                                              oninput="updateCharCount()"></textarea>
                                    <div class="text-right text-sm text-gray-500 mt-1">
                                        <span id="charCount">0</span>/500
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Step 16: Contact Information & Submit -->
                        <div id="step16" class="step-content step-hidden">
                            <h2 class="text-2xl font-bold mb-6" style="color: #1A1D2E;">Contact Information</h2>

                            <div class="space-y-6">
                                <!-- Name -->
                                <div>
                                    <label class="font-bold text-lg mb-2 block" style="color: #2D3E8F;">üë§ Name <span class="text-red-500">*</span></label>
                                    <input type="text" id="contactName" required class="w-full p-3 border-2 rounded-lg focus:border-blue-500 focus:outline-none"
                                           placeholder="Your name" oninput="validateForm()">
                                </div>

                                <!-- Email -->
                                <div>
                                    <label class="font-bold text-lg mb-2 block" style="color: #2D3E8F;">üìß Email <span class="text-red-500">*</span></label>
                                    <input type="email" id="contactEmail" required class="w-full p-3 border-2 rounded-lg focus:border-blue-500 focus:outline-none"
                                           placeholder="your@email.com" oninput="validateForm()">
                                </div>

                                <!-- Discord -->
                                <div>
                                    <label class="font-bold text-lg mb-2 block" style="color: #2D3E8F;">üí¨ Discord ID <span class="text-gray-500">(optional)</span></label>
                                    <input type="text" id="contactDiscord" class="w-full p-3 border-2 rounded-lg focus:border-blue-500 focus:outline-none"
                                           placeholder="mondupark or username#1234">
                                </div>

                                <!-- Privacy Policy -->
                                <div class="border-2 rounded-lg p-6 bg-gray-50">
                                    <label class="flex items-start cursor-pointer">
                                        <input type="checkbox" id="privacyAgree" class="mr-3 mt-1 w-5 h-5" style="accent-color: #2D3E8F;" onchange="validateForm()">
                                        <div>
                                            <span class="font-semibold">I agree to the collection and use of my personal information <span class="text-red-500">*</span></span>
                                            <button type="button" onclick="showPrivacyModal()" class="text-blue-600 hover:underline text-sm ml-1">(View details)</button>
                                            <p class="text-sm text-gray-600 mt-1">Information collected: Name, Email, Discord ID<br>
                                            Purpose: Commission inquiry response<br>
                                            Retention: 1 year after inquiry completion</p>
                                        </div>
                                    </label>
                                </div>

                                <!-- Submit Button -->
                                <div class="text-center pt-4">
                                    <button id="submitBtn" onclick="submitForm()" disabled
                                            class="px-8 py-4 text-white rounded-lg font-bold text-lg transition disabled:opacity-50 disabled:cursor-not-allowed"
                                            style="background: #E67E73;">
                                        üì® Send Quote Request
                                    </button>
                                    <p class="text-sm text-gray-500 mt-3">You'll receive a confirmation email shortly after submission</p>
                                </div>
                            </div>
                        </div>

                        <!-- Navigation Buttons -->
                        <div class="flex justify-between mt-8 pt-6 border-t">
                            <button id="prevBtn" onclick="previousStep()" class="px-6 py-3 border-2 rounded-lg font-semibold hover:bg-gray-50 transition" style="border-color: #2D3E8F; color: #2D3E8F;" disabled>
                                ‚Üê Previous
                            </button>
                            <button id="nextBtn" onclick="nextStep()" class="px-6 py-3 text-white rounded-lg font-semibold hover:opacity-90 transition" style="background: #2D3E8F;" disabled>
                                Next ‚Üí
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Right: Price Sidebar (30%) -->
                <div class="lg:col-span-1">
                    <div class="price-sidebar bg-white rounded-xl shadow-lg p-6">
                        <h3 class="text-xl font-bold mb-4" style="color: #2D3E8F;">üí∞ Estimated Quote</h3>

                        <div id="priceBreakdown" class="space-y-2 text-sm">
                            <div class="text-gray-500 text-center py-8">
                                Select options to see pricing
                            </div>
                        </div>

                        <div id="priceTotal" class="hidden">
                            <div class="border-t-2 my-4"></div>
                            <div class="mb-4">
                                <div class="text-sm text-gray-600 mb-1">Estimated Total:</div>
                                <div class="text-3xl font-bold" style="color: #2D3E8F;">
                                    $<span id="minPrice">0</span> ~ $<span id="maxPrice">0</span>
                                </div>
                            </div>
                            <div class="bg-yellow-50 border-l-4 border-yellow-500 p-3 text-xs text-gray-700">
                                ‚ö†Ô∏è Final price may vary ¬±10% after reference review
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Bottom Quote Panel -->
    <div id="mobileQuotePanel" class="mobile-quote-panel">
        <div class="mobile-quote-header" onclick="toggleMobileQuote()" role="button" aria-label="View quote details" tabindex="0">
            <div>
                <div class="text-xs text-gray-600">Estimated Total</div>
                <div class="text-lg font-bold" style="color: #2D3E8F;">
                    $<span id="mobileminPrice">0</span> ~ $<span id="mobileMaxPrice">0</span>
                </div>
            </div>
            <button class="text-blue-600 font-semibold" aria-label="Expand quote details">
                <span id="expandIcon">‚ñº</span> Details
            </button>
        </div>
    </div>

    <!-- Mobile Quote Modal -->
    <div id="mobileQuoteModal" class="mobile-quote-modal" onclick="closeMobileQuote(event)">
        <div class="mobile-quote-content" onclick="event.stopPropagation()">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold" style="color: #2D3E8F;">üí∞ Estimated Quote</h3>
                <button onclick="closeMobileQuote()" class="text-gray-500 text-2xl" aria-label="Close quote details">√ó</button>
            </div>
            <div id="mobileBreakdown" class="space-y-2 text-sm mb-4">
                <div class="text-gray-500 text-center py-4">
                    Select options to see pricing
                </div>
            </div>
            <div class="border-t-2 my-4"></div>
            <div class="mb-4">
                <div class="text-sm text-gray-600 mb-1">Estimated Total:</div>
                <div class="text-3xl font-bold" style="color: #2D3E8F;">
                    $<span id="mobileMinPriceModal">0</span> ~ $<span id="mobileMaxPriceModal">0</span>
                </div>
            </div>
            <div class="bg-yellow-50 border-l-4 border-yellow-500 p-3 text-xs text-gray-700">
                ‚ö†Ô∏è Final price may vary ¬±10% after reference review
            </div>
        </div>
    </div>

    <script src="mobile-menu.js"></script>

    <script>
        // Calculator State
        const state = {
            currentStep: 1,
            totalSteps: 16,
            uploadedFiles: [],
            selections: {
                service: null,
                servicePrice: 0,
                bodyType: null,
                bodyMultiplier: 1.0,
                complexity: null,
                complexityMultiplier: 1.0,
                // Sliders
                additionalExpressions: 0,
                customExpressions: 0,
                handPoses: 0,
                outfits: 0,
                hairstyles: 0,
                toggleAccessories: 0,
                // Checkboxes - Special Parts
                animalParts: false,
                wings: false,
                horns: false,
                glowEffects: false,
                // Checkboxes - Tracking
                handTracking: false,
                fullBodyTracking: false,
                advancedLipsync: false,
                iphoneArkit: false,
                // Checkboxes - Source Files
                blenderSource: false,
                fbxPsdSource: false,
                completeSource: false,
                // Radio - Commercial Rights
                commercialRights: 'personal',
                commercialMultiplier: 1.0,
                // Radio - Timeline
                timeline: 'standard',
                timelineMultiplier: 1.0,
                // Radio - Revisions
                revisions: 'standard',
                revisionsMultiplier: 1.0,
                // Checkbox - Confidentiality
                privateCommission: false,
                // References & Contact
                referenceUrls: '',
                additionalNotes: '',
                contactName: '',
                contactEmail: '',
                contactDiscord: '',
                privacyAgree: false
            }
        };

        const prices = {
            additionalExpressions: 50,
            customExpressions: 80,
            handPoses: 100,
            outfits: 600,
            hairstyles: 350,
            toggleAccessories: 120,
            animalParts: 250,
            wings: 300,
            horns: 180,
            glowEffects: 200,
            handTracking: 350,
            fullBodyTracking: 500,
            advancedLipsync: 180,
            iphoneArkit: 400,
            blenderSource: 350,
            fbxPsdSource: 280,
            completeSource: 600,
            privateCommission: 600
        };

        function startCalculator() {
            document.getElementById('openingMessage').classList.add('hidden');
            document.getElementById('calculatorContainer').classList.remove('hidden');
            updatePrice();
        }

        function selectService(type, price) {
            state.selections.service = type;
            state.selections.servicePrice = price;

            // Update UI
            document.querySelectorAll('.service-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');

            document.getElementById('nextBtn').disabled = false;
            updatePrice();
        }

        function selectBodyType(type, multiplier) {
            state.selections.bodyType = type;
            state.selections.bodyMultiplier = multiplier;
            document.getElementById('nextBtn').disabled = false;
            updatePrice();
        }

        function selectComplexity(type, multiplier) {
            state.selections.complexity = type;
            state.selections.complexityMultiplier = multiplier;

            // Update UI
            document.querySelectorAll('.complexity-card').forEach(card => {
                card.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');

            document.getElementById('nextBtn').disabled = false;
            updatePrice();
        }

        function updateSlider(id, pricePerItem, max) {
            const value = parseInt(document.getElementById(id).value);
            state.selections[id] = value;

            document.getElementById(id + 'Count').textContent = value;
            document.getElementById(id + 'Price').textContent = (value * pricePerItem).toLocaleString();

            updatePrice();
        }

        function updateCheckbox(id, price) {
            state.selections[id] = document.getElementById(id).checked;
            updatePrice();
        }

        function selectCommercialRights(type, multiplier) {
            state.selections.commercialRights = type;
            state.selections.commercialMultiplier = multiplier;
            updatePrice();
        }

        function selectTimeline(type, multiplier) {
            state.selections.timeline = type;
            state.selections.timelineMultiplier = multiplier;
            updatePrice();
        }

        function selectRevisions(type, multiplier) {
            state.selections.revisions = type;
            state.selections.revisionsMultiplier = multiplier;
            updatePrice();
        }

        function updatePrice() {
            const s = state.selections;

            if (!s.servicePrice) return;

            // 1. Base √ó body √ó complexity
            let price = s.servicePrice * s.bodyMultiplier * s.complexityMultiplier;
            const baseCalculated = price;

            // 2. Add all extras (sliders + checkboxes)
            const extras = {
                expressions: s.additionalExpressions * prices.additionalExpressions,
                customExpressions: s.customExpressions * prices.customExpressions,
                handPoses: s.handPoses * prices.handPoses,
                outfits: s.outfits * prices.outfits,
                hairstyles: s.hairstyles * prices.hairstyles,
                toggleAccessories: s.toggleAccessories * prices.toggleAccessories,
                animalParts: s.animalParts ? prices.animalParts : 0,
                wings: s.wings ? prices.wings : 0,
                horns: s.horns ? prices.horns : 0,
                glowEffects: s.glowEffects ? prices.glowEffects : 0,
                handTracking: s.handTracking ? prices.handTracking : 0,
                fullBodyTracking: s.fullBodyTracking ? prices.fullBodyTracking : 0,
                advancedLipsync: s.advancedLipsync ? prices.advancedLipsync : 0,
                iphoneArkit: s.iphoneArkit ? prices.iphoneArkit : 0,
                blenderSource: s.blenderSource ? prices.blenderSource : 0,
                fbxPsdSource: s.fbxPsdSource ? prices.fbxPsdSource : 0,
                completeSource: s.completeSource ? prices.completeSource : 0
            };

            const extrasTotal = Object.values(extras).reduce((a, b) => a + b, 0);
            price += extrasTotal;

            const priceBeforeMultipliers = price;

            // 3. Apply multipliers
            price *= s.commercialMultiplier;
            price *= s.timelineMultiplier;
            price *= s.revisionsMultiplier;

            // 4. Add confidentiality
            if (s.privateCommission) {
                price += prices.privateCommission;
            }

            // 5. Calculate range (¬±5%)
            const minPrice = Math.round(price * 0.95);
            const maxPrice = Math.round(price * 1.05);

            // Build breakdown display
            const breakdown = [];

            // Base section
            breakdown.push(`<div class="font-bold mb-2" style="color: #2D3E8F;">Base Calculation</div>`);
            breakdown.push(`<div class="flex justify-between"><span>Base Service:</span><span class="font-semibold">$${s.servicePrice.toLocaleString()}</span></div>`);

            if (s.bodyType) {
                const diff = Math.round(s.servicePrice * (s.bodyMultiplier - 1));
                const sign = diff >= 0 ? '+' : '';
                const label = s.bodyType.charAt(0).toUpperCase() + s.bodyType.slice(1);
                breakdown.push(`<div class="flex justify-between text-sm"><span>${label} (√ó${s.bodyMultiplier}):</span><span>${sign}$${diff.toLocaleString()}</span></div>`);
            }

            if (s.complexity) {
                const diff = Math.round(s.servicePrice * s.bodyMultiplier * (s.complexityMultiplier - 1));
                const label = s.complexity.charAt(0).toUpperCase() + s.complexity.slice(1);
                breakdown.push(`<div class="flex justify-between text-sm"><span>${label} (√ó${s.complexityMultiplier}):</span><span>+$${diff.toLocaleString()}</span></div>`);
            }

            breakdown.push(`<div class="border-t my-2"></div>`);
            breakdown.push(`<div class="flex justify-between font-semibold"><span>Subtotal:</span><span>$${Math.round(baseCalculated).toLocaleString()}</span></div>`);

            // Add-ons section
            if (extrasTotal > 0) {
                breakdown.push(`<div class="border-t my-3"></div>`);
                breakdown.push(`<div class="font-bold mb-2" style="color: #2D3E8F;">Add-ons</div>`);

                if (extras.expressions > 0) breakdown.push(`<div class="flex justify-between text-sm"><span>Expressions (${s.additionalExpressions}):</span><span>+$${extras.expressions.toLocaleString()}</span></div>`);
                if (extras.customExpressions > 0) breakdown.push(`<div class="flex justify-between text-sm"><span>Custom Expr. (${s.customExpressions}):</span><span>+$${extras.customExpressions.toLocaleString()}</span></div>`);
                if (extras.handPoses > 0) breakdown.push(`<div class="flex justify-between text-sm"><span>Hand Poses (${s.handPoses}):</span><span>+$${extras.handPoses.toLocaleString()}</span></div>`);
                if (extras.outfits > 0) breakdown.push(`<div class="flex justify-between text-sm"><span>Outfits (${s.outfits}):</span><span>+$${extras.outfits.toLocaleString()}</span></div>`);
                if (extras.hairstyles > 0) breakdown.push(`<div class="flex justify-between text-sm"><span>Hairstyles (${s.hairstyles}):</span><span>+$${extras.hairstyles.toLocaleString()}</span></div>`);
                if (extras.toggleAccessories > 0) breakdown.push(`<div class="flex justify-between text-sm"><span>Toggle Access. (${s.toggleAccessories}):</span><span>+$${extras.toggleAccessories.toLocaleString()}</span></div>`);
                if (extras.animalParts > 0) breakdown.push(`<div class="flex justify-between text-sm"><span>Animal Parts:</span><span>+$${extras.animalParts.toLocaleString()}</span></div>`);
                if (extras.wings > 0) breakdown.push(`<div class="flex justify-between text-sm"><span>Wings:</span><span>+$${extras.wings.toLocaleString()}</span></div>`);
                if (extras.horns > 0) breakdown.push(`<div class="flex justify-between text-sm"><span>Horns:</span><span>+$${extras.horns.toLocaleString()}</span></div>`);
                if (extras.glowEffects > 0) breakdown.push(`<div class="flex justify-between text-sm"><span>Glow Effects:</span><span>+$${extras.glowEffects.toLocaleString()}</span></div>`);
                if (extras.handTracking > 0) breakdown.push(`<div class="flex justify-between text-sm"><span>Hand Tracking:</span><span>+$${extras.handTracking.toLocaleString()}</span></div>`);
                if (extras.fullBodyTracking > 0) breakdown.push(`<div class="flex justify-between text-sm"><span>Full Body Track:</span><span>+$${extras.fullBodyTracking.toLocaleString()}</span></div>`);
                if (extras.advancedLipsync > 0) breakdown.push(`<div class="flex justify-between text-sm"><span>Adv. Lipsync:</span><span>+$${extras.advancedLipsync.toLocaleString()}</span></div>`);
                if (extras.iphoneArkit > 0) breakdown.push(`<div class="flex justify-between text-sm"><span>iPhone ARKit:</span><span>+$${extras.iphoneArkit.toLocaleString()}</span></div>`);
                if (extras.blenderSource > 0) breakdown.push(`<div class="flex justify-between text-sm"><span>Blender Source:</span><span>+$${extras.blenderSource.toLocaleString()}</span></div>`);
                if (extras.fbxPsdSource > 0) breakdown.push(`<div class="flex justify-between text-sm"><span>FBX+PSD Source:</span><span>+$${extras.fbxPsdSource.toLocaleString()}</span></div>`);
                if (extras.completeSource > 0) breakdown.push(`<div class="flex justify-between text-sm"><span>Complete Source:</span><span>+$${extras.completeSource.toLocaleString()}</span></div>`);

                breakdown.push(`<div class="border-t my-2"></div>`);
                breakdown.push(`<div class="flex justify-between font-semibold"><span>Add-ons Total:</span><span>+$${extrasTotal.toLocaleString()}</span></div>`);
            }

            // Multipliers section
            if (s.commercialMultiplier !== 1.0 || s.timelineMultiplier !== 1.0 || s.revisionsMultiplier !== 1.0) {
                breakdown.push(`<div class="border-t my-3"></div>`);
                breakdown.push(`<div class="font-bold mb-2" style="color: #2D3E8F;">Adjustments</div>`);

                if (s.commercialMultiplier !== 1.0) {
                    const rightsLabels = { personal: 'Personal', commercial: 'Commercial', merchandise: 'Merchandise', full: 'Full Rights' };
                    const diff = Math.round(priceBeforeMultipliers * (s.commercialMultiplier - 1));
                    breakdown.push(`<div class="flex justify-between text-sm"><span>${rightsLabels[s.commercialRights]} (√ó${s.commercialMultiplier}):</span><span>+$${diff.toLocaleString()}</span></div>`);
                }

                if (s.timelineMultiplier !== 1.0) {
                    const timelineLabels = { relaxed: 'Relaxed', standard: 'Standard', rush: 'Rush', express: 'Express' };
                    const currentPrice = priceBeforeMultipliers * s.commercialMultiplier;
                    const diff = Math.round(currentPrice * (s.timelineMultiplier - 1));
                    const sign = diff >= 0 ? '+' : '';
                    breakdown.push(`<div class="flex justify-between text-sm"><span>${timelineLabels[s.timeline]} (√ó${s.timelineMultiplier}):</span><span>${sign}$${diff.toLocaleString()}</span></div>`);
                }

                if (s.revisionsMultiplier !== 1.0) {
                    const revisionLabels = { standard: 'Standard', extended: 'Extended', unlimited: 'Unlimited' };
                    const currentPrice = priceBeforeMultipliers * s.commercialMultiplier * s.timelineMultiplier;
                    const diff = Math.round(currentPrice * (s.revisionsMultiplier - 1));
                    breakdown.push(`<div class="flex justify-between text-sm"><span>${revisionLabels[s.revisions]} Revisions (√ó${s.revisionsMultiplier}):</span><span>+$${diff.toLocaleString()}</span></div>`);
                }
            }

            // Confidentiality
            if (s.privateCommission) {
                breakdown.push(`<div class="border-t my-2"></div>`);
                breakdown.push(`<div class="flex justify-between text-sm"><span>Private Commission:</span><span>+$${prices.privateCommission.toLocaleString()}</span></div>`);
            }

            document.getElementById('priceBreakdown').innerHTML = breakdown.join('');
            document.getElementById('minPrice').textContent = minPrice.toLocaleString();
            document.getElementById('maxPrice').textContent = maxPrice.toLocaleString();
            document.getElementById('priceTotal').classList.remove('hidden');

            // Update mobile panels
            document.getElementById('mobileminPrice').textContent = minPrice.toLocaleString();
            document.getElementById('mobileMaxPrice').textContent = maxPrice.toLocaleString();
            document.getElementById('mobileMinPriceModal').textContent = minPrice.toLocaleString();
            document.getElementById('mobileMaxPriceModal').textContent = maxPrice.toLocaleString();
            document.getElementById('mobileBreakdown').innerHTML = breakdown.join('');
        }

        function nextStep() {
            if (state.currentStep < state.totalSteps) {
                // Save progress before moving
                saveProgress();

                // Hide current step
                document.getElementById(`step${state.currentStep}`).classList.remove('step-visible');
                document.getElementById(`step${state.currentStep}`).classList.add('step-hidden');

                // Show next step
                state.currentStep++;
                document.getElementById(`step${state.currentStep}`).classList.remove('step-hidden');
                document.getElementById(`step${state.currentStep}`).classList.add('step-visible');

                // Update progress
                updateProgress();

                // Disable next button until selection is made
                if (state.currentStep < state.totalSteps) {
                    // Auto-enable for steps that don't require selection or have default values
                    // Step 3 (Platform - info only), 5 (What's Included - info only)
                    // Step 6-10 (Optional sliders/checkboxes), 11-13 (Radio with defaults)
                    // Step 14 (Confidentiality - optional), 15 (References - optional)
                    if ([3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15].includes(state.currentStep)) {
                        document.getElementById('nextBtn').disabled = false;
                    } else {
                        document.getElementById('nextBtn').disabled = true;
                    }
                } else {
                    document.getElementById('nextBtn').classList.add('hidden');
                }

                // Enable previous button
                document.getElementById('prevBtn').disabled = false;
            }
        }

        function previousStep() {
            if (state.currentStep > 1) {
                // Save progress before moving
                saveProgress();

                // Hide current step
                document.getElementById(`step${state.currentStep}`).classList.remove('step-visible');
                document.getElementById(`step${state.currentStep}`).classList.add('step-hidden');

                // Show previous step
                state.currentStep--;
                document.getElementById(`step${state.currentStep}`).classList.remove('step-hidden');
                document.getElementById(`step${state.currentStep}`).classList.add('step-visible');

                // Update progress
                updateProgress();

                // Enable next button
                document.getElementById('nextBtn').disabled = false;
                document.getElementById('nextBtn').classList.remove('hidden');

                // Disable previous button if at first step
                if (state.currentStep === 1) {
                    document.getElementById('prevBtn').disabled = true;
                }
            }
        }

        function updateProgress() {
            const progress = (state.currentStep / state.totalSteps) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentStep').textContent = state.currentStep;

            const titles = [
                'Service Type',
                'Body Type',
                'Platform Selection',
                'Character Complexity',
                "What's Included",
                'Expressions & Emotes',
                'Hand Poses',
                'Outfits & Hair',
                'Special Parts & Tracking',
                'Source Files',
                'Commercial Rights',
                'Delivery Timeline',
                'Revision Rounds',
                'Confidentiality',
                'Reference Images & Details',
                'Contact Information'
            ];
            document.getElementById('stepTitle').textContent = titles[state.currentStep - 1];
        }

        // File Upload Handling
        function handleDragOver(e) {
            e.preventDefault();
            e.stopPropagation();
            document.getElementById('dropZone').style.borderColor = '#2D3E8F';
        }

        function handleDragLeave(e) {
            e.preventDefault();
            e.stopPropagation();
            document.getElementById('dropZone').style.borderColor = '';
        }

        function handleDrop(e) {
            e.preventDefault();
            e.stopPropagation();
            document.getElementById('dropZone').style.borderColor = '';

            const files = Array.from(e.dataTransfer.files);
            processFiles(files);
        }

        function handleFileSelect(e) {
            const files = Array.from(e.target.files);
            processFiles(files);
        }

        function processFiles(files) {
            const validTypes = ['image/jpeg', 'image/png', 'image/webp'];
            const maxSize = 10 * 1024 * 1024; // 10MB
            const maxFiles = 5;

            files.forEach(file => {
                if (state.uploadedFiles.length >= maxFiles) {
                    alert('Maximum 5 images allowed');
                    return;
                }

                if (!validTypes.includes(file.type)) {
                    alert(`${file.name}: Unsupported file type. Please use JPG, PNG, or WEBP.`);
                    return;
                }

                if (file.size > maxSize) {
                    alert(`${file.name}: File too large. Maximum size is 10MB.`);
                    return;
                }

                state.uploadedFiles.push(file);
                displayImagePreview(file);
            });
        }

        function displayImagePreview(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const previewContainer = document.getElementById('imagePreviews');
                const index = state.uploadedFiles.indexOf(file);

                const div = document.createElement('div');
                div.className = 'relative';
                div.innerHTML = `
                    <img src="${e.target.result}" class="w-full h-24 object-cover rounded-lg border-2 border-gray-300">
                    <button onclick="removeImage(${index})" class="absolute top-1 right-1 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600">
                        ‚úï
                    </button>
                `;
                previewContainer.appendChild(div);
            };
            reader.readAsDataURL(file);
        }

        function removeImage(index) {
            state.uploadedFiles.splice(index, 1);
            const previewContainer = document.getElementById('imagePreviews');
            previewContainer.innerHTML = '';
            state.uploadedFiles.forEach(file => displayImagePreview(file));
        }

        function updateCharCount() {
            const textarea = document.getElementById('additionalNotes');
            const charCount = document.getElementById('charCount');
            charCount.textContent = textarea.value.length;
            state.selections.additionalNotes = textarea.value;
        }

        // Form Validation
        function validateForm() {
            const name = document.getElementById('contactName').value.trim();
            const email = document.getElementById('contactEmail').value.trim();
            const privacyAgree = document.getElementById('privacyAgree').checked;

            state.selections.contactName = name;
            state.selections.contactEmail = email;
            state.selections.contactDiscord = document.getElementById('contactDiscord').value.trim();
            state.selections.privacyAgree = privacyAgree;

            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            const isValid = name && email && emailRegex.test(email) && privacyAgree;

            document.getElementById('submitBtn').disabled = !isValid;
        }

        function showPrivacyModal() {
            alert('Privacy Policy\n\nInformation collected: Name, Email, Discord ID\nPurpose: Commission inquiry response and communication\nRetention: 1 year after inquiry completion\nUsage: We will only use your information to respond to your commission inquiry and will not share it with third parties.');
        }

        // Form Submission
        async function submitForm() {
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="inline-block animate-spin">‚è≥</span> Sending...';

            try {
                // Collect all data
                const formData = collectFormData();

                // Send to Discord (if webhook URL is configured)
                await sendToDiscord(formData);

                // Send confirmation email (if EmailJS is configured)
                await sendConfirmationEmail(formData);

                // Success message
//                alert('‚úÖ Your inquiry has been received!\n\nPlease check your email for confirmation.\n\nI\'ll review your request and get back to you within 1-2 business days.');

                // Reset and go back to step 1
                window.location.reload();

            } catch (error) {
                console.error('Submission error:', error);
                alert('‚ùå Something went wrong. Please try again or email us directly at dhpark9609@gmail.com');
                submitBtn.disabled = false;
                submitBtn.innerHTML = 'üì® Send Quote Request';
            }
        }

        function collectFormData() {
            const s = state.selections;
            const { servicePrice, bodyMultiplier, complexityMultiplier } = s;

            let price = servicePrice * bodyMultiplier * complexityMultiplier;
            price += s.additionalExpressions * prices.additionalExpressions;
            price += s.customExpressions * prices.customExpressions;
            price += s.handPoses * prices.handPoses;
            price += s.outfits * prices.outfits;
            price += s.hairstyles * prices.hairstyles;
            price += s.toggleAccessories * prices.toggleAccessories;
            price += s.animalParts ? prices.animalParts : 0;
            price += s.wings ? prices.wings : 0;
            price += s.horns ? prices.horns : 0;
            price += s.glowEffects ? prices.glowEffects : 0;
            price += s.handTracking ? prices.handTracking : 0;
            price += s.fullBodyTracking ? prices.fullBodyTracking : 0;
            price += s.advancedLipsync ? prices.advancedLipsync : 0;
            price += s.iphoneArkit ? prices.iphoneArkit : 0;
            price += s.blenderSource ? prices.blenderSource : 0;
            price += s.fbxPsdSource ? prices.fbxPsdSource : 0;
            price += s.completeSource ? prices.completeSource : 0;

            price *= s.commercialMultiplier;
            price *= s.timelineMultiplier;
            price *= s.revisionsMultiplier;

            if (s.privateCommission) price += prices.privateCommission;

            const minPrice = Math.round(price * 0.95);
            const maxPrice = Math.round(price * 1.05);

            return {
                contact: {
                    name: s.contactName,
                    email: s.contactEmail,
                    discord: s.contactDiscord || 'N/A'
                },
                selections: s,
                pricing: { minPrice, maxPrice },
                files: state.uploadedFiles,
                referenceUrls: document.getElementById('referenceUrls').value,
                additionalNotes: s.additionalNotes || 'N/A',
                timestamp: new Date().toLocaleString('en-US', { timeZone: 'Asia/Seoul' }) + ' KST'
            };
        }

        async function sendToDiscord(formData) {
            // NOTE: For production, set DISCORD_WEBHOOK_URL as environment variable
            // or use a serverless function to keep the webhook URL secret
            const webhookUrl = ''; // Set your Discord webhook URL here or use env variable

            if (!webhookUrl) {
                console.log('Discord webhook not configured. Skipping Discord notification.');
                return;
            }

            const s = formData.selections;
            const serviceTypes = { full: 'Full Package ($8,000)', custom: 'Custom 3D Model ($4,000)', vroid: 'VRoid Customization ($1,500)', rigging: 'Rigging Only ($800)' };
            const bodyTypes = { fullbody: 'Fullbody (√ó1.0)', halfbody: 'Halfbody (√ó0.7)', chibi: 'Chibi (√ó0.6)' };
            const complexityTypes = { simple: 'Simple (√ó1.0)', standard: 'Standard (√ó1.4)', complex: 'Complex (√ó1.8)' };
            const rightsTypes = { personal: 'Personal Use Only', commercial: 'Commercial Use', merchandise: 'Merchandise Rights', full: 'Full Rights Transfer' };
            const timelineTypes = { relaxed: 'Relaxed (10-12 weeks)', standard: 'Standard (8-10 weeks)', rush: 'Rush (6 weeks)', express: 'Express (4 weeks)' };
            const revisionTypes = { standard: 'Standard (1 per stage)', extended: 'Extended (3 per stage)', unlimited: 'Unlimited' };

            let addons = [];
            if (s.additionalExpressions > 0) addons.push(`‚Ä¢ Additional Expressions: ${s.additionalExpressions} (+$${s.additionalExpressions * 50})`);
            if (s.customExpressions > 0) addons.push(`‚Ä¢ Custom Expressions: ${s.customExpressions} (+$${s.customExpressions * 80})`);
            if (s.handPoses > 0) addons.push(`‚Ä¢ Hand Poses: ${s.handPoses} (+$${s.handPoses * 100})`);
            if (s.outfits > 0) addons.push(`‚Ä¢ Additional Outfits: ${s.outfits} (+$${s.outfits * 600})`);
            if (s.hairstyles > 0) addons.push(`‚Ä¢ Additional Hairstyles: ${s.hairstyles} (+$${s.hairstyles * 350})`);
            if (s.toggleAccessories > 0) addons.push(`‚Ä¢ Toggle Accessories: ${s.toggleAccessories} (+$${s.toggleAccessories * 120})`);
            if (s.animalParts) addons.push('‚Ä¢ Animal Ears + Tail (+$250)');
            if (s.wings) addons.push('‚Ä¢ Wings (+$300)');
            if (s.horns) addons.push('‚Ä¢ Horns/Antennae (+$180)');
            if (s.glowEffects) addons.push('‚Ä¢ Glow Effects (+$200)');
            if (s.handTracking) addons.push('‚Ä¢ Hand Tracking Support (+$350)');
            if (s.fullBodyTracking) addons.push('‚Ä¢ Full Body Tracking (+$500)');
            if (s.advancedLipsync) addons.push('‚Ä¢ Advanced Lipsync (10 visemes) (+$180)');
            if (s.iphoneArkit) addons.push('‚Ä¢ iPhone ARKit Facial Tracking (+$400)'); // ‚≠ê ARKit included

            let sourceFiles = [];
            if (s.blenderSource) sourceFiles.push('‚Ä¢ Blender Source Files (+$350)');
            if (s.fbxPsdSource) sourceFiles.push('‚Ä¢ FBX + PSD Source (+$280)');
            if (s.completeSource) sourceFiles.push('‚Ä¢ Complete Source Package (+$600)');

            const message = {
                content: `üé® **New VTuber Commission Inquiry!**
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

**üë§ Client:** ${formData.contact.name}
**üìß Email:** ${formData.contact.email}
**üí¨ Discord:** ${formData.contact.discord}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

**üìä Selected Options:**

‚Ä¢ **Service:** ${serviceTypes[s.service]}
‚Ä¢ **Body Type:** ${bodyTypes[s.bodyType]}
‚Ä¢ **Complexity:** ${complexityTypes[s.complexity]}
‚Ä¢ **Platform:** VRM Standard

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

**‚ú® Add-ons:**
${addons.length > 0 ? addons.join('\n') : 'None'}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

**üìÅ Source Files:**
${sourceFiles.length > 0 ? sourceFiles.join('\n') : 'Standard only (VRM, Unity, PNG)'}

**‚öñÔ∏è Rights:** ${rightsTypes[s.commercialRights]}
**‚è±Ô∏è Timeline:** ${timelineTypes[s.timeline]}
**üîÑ Revisions:** ${revisionTypes[s.revisions]}
**üîí Private:** ${s.privateCommission ? '‚úì' : '‚úó'}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

**üí∞ Estimated Quote:** $${formData.pricing.minPrice.toLocaleString()} ~ $${formData.pricing.maxPrice.toLocaleString()}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

**üìé References:** ${formData.files.length} images attached
${formData.referenceUrls ? '**üîó URLs:**\n' + formData.referenceUrls : ''}

**üí¨ Additional Notes:**
"${formData.additionalNotes}"

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

**üìÖ Inquiry Time:** ${formData.timestamp}`
            };

            await fetch(webhookUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(message)
            });
        }

        async function sendConfirmationEmail(formData) {
            // NOTE: Configure EmailJS with your service ID, template ID, and public key
            // Sign up at https://www.emailjs.com/ and create a template
            const serviceId = ''; // 'service_pghdwkd'; // Your EmailJS service ID
                    const templateId = 'template_pd2dimn'; // 'template_pd2dimn'; // Your EmailJS template ID
                    const publicKey = 'VIO7CsFr-pEg7Muvr'; // 'VIO7CsFr-pEg7Muvr'; // Your EmailJS public key

                    const serviceId = 'service_pghdwkd'; // 'service_pghdwkd'; // Your EmailJS service ID
                console.log('EmailJS not configured. Skipping confirmation email.');
                return;
            }

            const s = formData.selections;
            const serviceTypes = { full: 'Full Package', custom: 'Custom 3D Model', vroid: 'VRoid Customization', rigging: 'Rigging Only' };

            const emailData = {
                to_email: formData.contact.email,
                to_name: formData.contact.name,
                service_type: serviceTypes[s.service],
                body_type: s.bodyType,
                complexity: s.complexity,
                min_price: formData.pricing.minPrice.toLocaleString(),
                max_price: formData.pricing.maxPrice.toLocaleString(),
                reply_to: 'dhpark9609@gmail.com'
            };

            // Load EmailJS SDK if not already loaded
            if (typeof emailjs === 'undefined') {
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js';
                script.onload = () => {
                    emailjs.init(publicKey);
                    emailjs.send(serviceId, templateId, emailData);
                };
                document.head.appendChild(script);
            } else {
                await emailjs.send(serviceId, templateId, emailData);
            }
        }

        // Mobile Quote Panel Functions
        function toggleMobileQuote() {
            const modal = document.getElementById('mobileQuoteModal');
            const icon = document.getElementById('expandIcon');
            modal.classList.toggle('active');
            icon.textContent = modal.classList.contains('active') ? '‚ñ≤' : '‚ñº';
        }

        function closeMobileQuote(event) {
            if (event && event.target.id !== 'mobileQuoteModal') return;
            const modal = document.getElementById('mobileQuoteModal');
            const icon = document.getElementById('expandIcon');
            modal.classList.remove('active');
            icon.textContent = '‚ñº';
        }

        // LocalStorage Progress Saving
        function saveProgress() {
            try {
                const progressData = {
                    currentStep: state.currentStep,
                    selections: state.selections,
                    uploadedFilesCount: state.uploadedFiles.length,
                    timestamp: Date.now()
                };
                localStorage.setItem('vtuberQuoteProgress', JSON.stringify(progressData));
            } catch (error) {
                console.error('Error saving progress:', error);
            }
        }

        function loadProgress() {
            try {
                const saved = localStorage.getItem('vtuberQuoteProgress');
                if (!saved) return null;

                const data = JSON.parse(saved);
                const hoursSinceLastSave = (Date.now() - data.timestamp) / (1000 * 60 * 60);

                // Only restore if less than 24 hours old
                if (hoursSinceLastSave < 24) {
                    return data;
                }

                // Clear old data
                localStorage.removeItem('vtuberQuoteProgress');
                return null;
            } catch (error) {
                console.error('Error loading progress:', error);
                return null;
            }
        }

        function showRestorePrompt(savedData) {
            const message = `üíæ Previous progress found from ${new Date(savedData.timestamp).toLocaleString()}.\n\nWould you like to continue where you left off?`;
            if (confirm(message)) {
                restoreProgress(savedData);
            } else {
                localStorage.removeItem('vtuberQuoteProgress');
            }
        }

        function restoreProgress(savedData) {
            // Restore selections
            Object.assign(state.selections, savedData.selections);

            // Restore step
            state.currentStep = savedData.currentStep;

            // Hide opening message and show calculator
            document.getElementById('openingMessage').classList.add('hidden');
            document.getElementById('calculatorContainer').classList.remove('hidden');

            // Navigate to saved step
            for (let i = 1; i <= state.totalSteps; i++) {
                const stepEl = document.getElementById(`step${i}`);
                if (i === state.currentStep) {
                    stepEl.classList.remove('step-hidden');
                    stepEl.classList.add('step-visible');
                } else {
                    stepEl.classList.remove('step-visible');
                    stepEl.classList.add('step-hidden');
                }
            }

            // Update progress bar
            updateProgress();

            // Restore UI states
            restoreUIStates();

            // Update price
            updatePrice();

            // Enable/disable navigation buttons
            document.getElementById('prevBtn').disabled = state.currentStep === 1;
            document.getElementById('nextBtn').disabled = false;

            alert('‚úÖ Progress restored! You can continue from where you left off.');
        }

        function restoreUIStates() {
            const s = state.selections;

            // Restore service selection
            if (s.service) {
                const serviceCard = document.querySelector(`.service-card input[value="${s.service}"]`)?.closest('.service-card');
                if (serviceCard) serviceCard.classList.add('selected');
            }

            // Restore body type
            if (s.bodyType) {
                const bodyRadio = document.querySelector(`input[name="bodyType"][value="${s.bodyType}"]`);
                if (bodyRadio) bodyRadio.checked = true;
            }

            // Restore complexity
            if (s.complexity) {
                const complexityCard = document.querySelector(`.complexity-card`);
                // You could add more specific restoration here
            }

            // Restore sliders
            ['additionalExpressions', 'customExpressions', 'handPoses', 'outfits', 'hairstyles', 'toggleAccessories'].forEach(id => {
                const slider = document.getElementById(id);
                if (slider && s[id]) {
                    slider.value = s[id];
                    updateSlider(id, prices[id], slider.max);
                }
            });

            // Restore checkboxes
            ['animalParts', 'wings', 'horns', 'glowEffects', 'handTracking', 'fullBodyTracking',
             'advancedLipsync', 'iphoneArkit', 'blenderSource', 'fbxPsdSource', 'completeSource',
             'privateCommission'].forEach(id => {
                const checkbox = document.getElementById(id);
                if (checkbox && s[id]) {
                    checkbox.checked = true;
                }
            });

            // Restore radio buttons
            if (s.commercialRights) {
                const radio = document.querySelector(`input[name="commercialRights"][value="${s.commercialRights}"]`);
                if (radio) radio.checked = true;
            }
            if (s.timeline) {
                const radio = document.querySelector(`input[name="timeline"][value="${s.timeline}"]`);
                if (radio) radio.checked = true;
            }
            if (s.revisions) {
                const radio = document.querySelector(`input[name="revisions"][value="${s.revisions}"]`);
                if (radio) radio.checked = true;
            }

            // Restore text inputs
            if (s.referenceUrls) document.getElementById('referenceUrls').value = s.referenceUrls;
            if (s.additionalNotes) {
                document.getElementById('additionalNotes').value = s.additionalNotes;
                updateCharCount();
            }
            if (s.contactName) document.getElementById('contactName').value = s.contactName;
            if (s.contactEmail) document.getElementById('contactEmail').value = s.contactEmail;
            if (s.contactDiscord) document.getElementById('contactDiscord').value = s.contactDiscord;
            if (s.privacyAgree) document.getElementById('privacyAgree').checked = true;
        }

        // Enhanced error handling for submissions
        async function sendToDiscord(formData) {
            const webhookUrl = ''; // Set your Discord webhook URL here

            if (!webhookUrl) {
                console.log('Discord webhook not configured. Skipping Discord notification.');
                return { success: true, skipped: true };
            }

            try {
                const s = formData.selections;
                const serviceTypes = { full: 'Full Package ($8,000)', custom: 'Custom 3D Model ($4,000)', vroid: 'VRoid Customization ($1,500)', rigging: 'Rigging Only ($800)' };
                const bodyTypes = { fullbody: 'Fullbody (√ó1.0)', halfbody: 'Halfbody (√ó0.7)', chibi: 'Chibi (√ó0.6)' };
                const complexityTypes = { simple: 'Simple (√ó1.0)', standard: 'Standard (√ó1.4)', complex: 'Complex (√ó1.8)' };
                const rightsTypes = { personal: 'Personal Use Only', commercial: 'Commercial Use', merchandise: 'Merchandise Rights', full: 'Full Rights Transfer' };
                const timelineTypes = { relaxed: 'Relaxed (10-12 weeks)', standard: 'Standard (8-10 weeks)', rush: 'Rush (6 weeks)', express: 'Express (4 weeks)' };
                const revisionTypes = { standard: 'Standard (1 per stage)', extended: 'Extended (3 per stage)', unlimited: 'Unlimited' };

                let addons = [];
                if (s.additionalExpressions > 0) addons.push(`‚Ä¢ Additional Expressions: ${s.additionalExpressions} (+$${s.additionalExpressions * 50})`);
                if (s.customExpressions > 0) addons.push(`‚Ä¢ Custom Expressions: ${s.customExpressions} (+$${s.customExpressions * 80})`);
                if (s.handPoses > 0) addons.push(`‚Ä¢ Hand Poses: ${s.handPoses} (+$${s.handPoses * 100})`);
                if (s.outfits > 0) addons.push(`‚Ä¢ Additional Outfits: ${s.outfits} (+$${s.outfits * 600})`);
                if (s.hairstyles > 0) addons.push(`‚Ä¢ Additional Hairstyles: ${s.hairstyles} (+$${s.hairstyles * 350})`);
                if (s.toggleAccessories > 0) addons.push(`‚Ä¢ Toggle Accessories: ${s.toggleAccessories} (+$${s.toggleAccessories * 120})`);
                if (s.animalParts) addons.push('‚Ä¢ Animal Ears + Tail (+$250)');
                if (s.wings) addons.push('‚Ä¢ Wings (+$300)');
                if (s.horns) addons.push('‚Ä¢ Horns/Antennae (+$180)');
                if (s.glowEffects) addons.push('‚Ä¢ Glow Effects (+$200)');
                if (s.handTracking) addons.push('‚Ä¢ Hand Tracking Support (+$350)');
                if (s.fullBodyTracking) addons.push('‚Ä¢ Full Body Tracking (+$500)');
                if (s.advancedLipsync) addons.push('‚Ä¢ Advanced Lipsync (10 visemes) (+$180)');
                if (s.iphoneArkit) addons.push('‚Ä¢ iPhone ARKit Facial Tracking (+$400)');

                let sourceFiles = [];
                if (s.blenderSource) sourceFiles.push('‚Ä¢ Blender Source Files (+$350)');
                if (s.fbxPsdSource) sourceFiles.push('‚Ä¢ FBX + PSD Source (+$280)');
                if (s.completeSource) sourceFiles.push('‚Ä¢ Complete Source Package (+$600)');

                const message = {
                    content: `üé® **New VTuber Commission Inquiry!**
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

**üë§ Client:** ${formData.contact.name}
**üìß Email:** ${formData.contact.email}
**üí¨ Discord:** ${formData.contact.discord}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

**üìä Selected Options:**

‚Ä¢ **Service:** ${serviceTypes[s.service]}
‚Ä¢ **Body Type:** ${bodyTypes[s.bodyType]}
‚Ä¢ **Complexity:** ${complexityTypes[s.complexity]}
‚Ä¢ **Platform:** VRM Standard

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

**‚ú® Add-ons:**
${addons.length > 0 ? addons.join('\n') : 'None'}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

**üìÅ Source Files:**
${sourceFiles.length > 0 ? sourceFiles.join('\n') : 'Standard only (VRM, Unity, PNG)'}

**‚öñÔ∏è Rights:** ${rightsTypes[s.commercialRights]}
**‚è±Ô∏è Timeline:** ${timelineTypes[s.timeline]}
**üîÑ Revisions:** ${revisionTypes[s.revisions]}
**üîí Private:** ${s.privateCommission ? '‚úì' : '‚úó'}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

**üí∞ Estimated Quote:** $${formData.pricing.minPrice.toLocaleString()} ~ $${formData.pricing.maxPrice.toLocaleString()}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

**üìé References:** ${formData.files.length} images attached
${formData.referenceUrls ? '**üîó URLs:**\n' + formData.referenceUrls : ''}

**üí¨ Additional Notes:**
"${formData.additionalNotes}"

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

**üìÖ Inquiry Time:** ${formData.timestamp}`
                };

                const response = await fetch(webhookUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(message)
                });

                if (!response.ok) {
                    throw new Error(`Discord webhook failed: ${response.status}`);
                }

                return { success: true };
            } catch (error) {
                console.error('Discord send error:', error);
                return { success: false, error: error.message };
            }
        }

        async function sendConfirmationEmail(formData) {
            const serviceId = '';
            const templateId = '';
            const publicKey = '';

            if (!serviceId || !templateId || !publicKey) {
                console.log('EmailJS not configured. Skipping confirmation email.');
                return { success: true, skipped: true };
            }

            try {
                const s = formData.selections;
                const serviceTypes = { full: 'Full Package', custom: 'Custom 3D Model', vroid: 'VRoid Customization', rigging: 'Rigging Only' };

                const emailData = {
                    to_email: formData.contact.email,
                    to_name: formData.contact.name,
                    service_type: serviceTypes[s.service],
                    body_type: s.bodyType,
                    complexity: s.complexity,
                    min_price: formData.pricing.minPrice.toLocaleString(),
                    max_price: formData.pricing.maxPrice.toLocaleString(),
                    reply_to: 'dhpark9609@gmail.com'
                };

                if (typeof emailjs === 'undefined') {
                    const script = document.createElement('script');
                    script.src = 'https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js';
                    await new Promise((resolve, reject) => {
                        script.onload = () => {
                            emailjs.init(publicKey);
                            emailjs.send(serviceId, templateId, emailData)
                                .then(resolve)
                                .catch(reject);
                        };
                        script.onerror = reject;
                        document.head.appendChild(script);
                    });
                } else {
                    await emailjs.send(serviceId, templateId, emailData);
                }

                return { success: true };
            } catch (error) {
                console.error('Email send error:', error);
                return { success: false, error: error.message };
            }
        }

        // Enhanced submitForm with better error handling
        async function submitForm() {
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<span class="inline-block animate-spin">‚è≥</span> Sending...';

            try {
                const formData = collectFormData();

                // Try to send to Discord
                const discordResult = await sendToDiscord(formData);

                // Try to send confirmation email
                const emailResult = await sendConfirmationEmail(formData);

                // Determine success message
                let successMessage = '‚úÖ Your inquiry has been received!';
                if (emailResult.success && !emailResult.skipped) {
                    successMessage += '\n\nPlease check your email for confirmation.';
                }
                successMessage += '\n\nI\'ll review your request and get back to you within 1-2 business days.';

                // Show warnings if any service failed
                if (!discordResult.success || !emailResult.success) {
                    successMessage += '\n\n‚ö†Ô∏è Note: Some notifications may not have been sent, but your request was saved.';
                }

                alert(successMessage);

                // Clear localStorage progress
                localStorage.removeItem('vtuberQuoteProgress');

                // Reset and go back to step 1
                window.location.reload();

            } catch (error) {
                console.error('Submission error:', error);
                alert('‚ùå Something went wrong. Please try again or email us directly at dhpark9609@gmail.com\n\nError: ' + error.message);
                submitBtn.disabled = false;
                submitBtn.innerHTML = 'üì® Send Quote Request';
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('VTuber Calculator initialized - 16 steps');

            // Check for saved progress
            const savedProgress = loadProgress();
            if (savedProgress) {
                showRestorePrompt(savedProgress);
            }

            // Add keyboard navigation
            document.addEventListener('keydown', function(e) {
                // Escape key closes mobile modal
                if (e.key === 'Escape') {
                    closeMobileQuote();
                }

                // Arrow keys for navigation (when not in input fields)
                if (!['INPUT', 'TEXTAREA'].includes(document.activeElement.tagName)) {
                    if (e.key === 'ArrowRight') {
                        const nextBtn = document.getElementById('nextBtn');
                        if (!nextBtn.disabled && !nextBtn.classList.contains('hidden')) {
                            nextStep();
                        }
                    } else if (e.key === 'ArrowLeft') {
                        const prevBtn = document.getElementById('prevBtn');
                        if (!prevBtn.disabled) {
                            previousStep();
                        }
                    }
                }
            });

            // Make mobile quote panel keyboard accessible
            const mobileHeader = document.querySelector('.mobile-quote-header');
            if (mobileHeader) {
                mobileHeader.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        toggleMobileQuote();
                    }
                });
            }
        });
    </script>
</body>
</html>
